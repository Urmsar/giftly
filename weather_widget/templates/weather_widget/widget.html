<style>
    .weather-widget {
        border: 1px solid #ddd;
        padding: 16px;
        border-radius: 8px;
        width: 200px;
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        box-shadow: 0px 0px 5px rgba(0,0,0,0.2);
        margin: 16px;
    }
    
    .weather-widget h2 {
        margin-top: 0;
        color: #333;
    }
    
    .weather-widget p {
        margin: 8px 0;
        font-size: 14px;
        color: #666;
    }
    
    .weather-widget .temperature {
        font-weight: bold;
        color: #444;
    }
</style>

<form id="weather-form">
    {% csrf_token %}
    <label for="location">Sisesta asukoht ilmateate nägemiseks:</label>
    <input type="text" id="location" required>
    <button type="submit">Otsi</button>
</form>

<div class="weather-widget">
    <!-- Weather data will appear here -->
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>

$(document).ready(function(){
    $("#weather-form").submit(function(e){
        e.preventDefault();
        $.ajax({
            url: "/weather_widget/fetch_weather/",
            method: "POST",
            data: {
                location: $("#location").val(),
                csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val()
            },
            success: function(data){
                if(data.city){
                    $(".weather-widget").html(`
                        <h2>${data.city}</h2>
                        <p class="temperature">Temperatuur: ${data.temperature}°C</p>
                        <p>Kirjeldus: ${data.description}</p>
                    `);
                } else {
                    alert("Linna ei leitud!");
                }
            },
            error: function(error){
                console.error(error);
            }
        });
    });
});
</script>
